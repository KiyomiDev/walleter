const userNameInput=document.querySelector(".settings__form .username__input"),userNameVal=localStorage.getItem("username"),baseCurrencySelect=document.querySelector(".base__currency-select"),baseCurrencyVal=localStorage.getItem("base__currency"),changeBtns=document.querySelectorAll(".settings__form .change"),saveChangesBtn=document.querySelector(".user__info .save"),headUserName=document.querySelector(".head .username"),cancelChangesBtn=document.querySelector(".user__info .cancel"),deleteUserData=document.querySelector(".confirm__account-deletion .delete"),confirmDeleteMsg=document.querySelector(".confirm__account-deletion"),overlay=document.querySelector(".settings .overlay"),closeModalBtn=document.querySelector(".confirm__account-deletion .close__icon"),cancelDelete=document.querySelector(".confirm__account-deletion .cancel"),deleteAcc=document.querySelector(".delete__user-account"),profilePic=document.querySelector(".profile__pic .image"),uploadUserImg=document.querySelector(".upload__image"),headUserImage=document.querySelector(".head .user__image"),profileImageUrl=localStorage.getItem("profile-image"),deleteUserImg=document.querySelector(".delete__pic"),defaultProfileImgUrl="url('/static/images/user-image.png')";userNameInput.value=userNameVal,fetch("../static/data/countriesInfo.json").then((e=>e.json())).then((e=>{e.forEach((e=>{const t=e.countryName,a=e.currencyName,r=e.currencyCode,c=`<option ${r===baseCurrencyVal?"selected":""} value="${r}" data-country-name=${t}>${r} - ${a}</option>`;baseCurrencySelect.insertAdjacentHTML("beforeend",c)}))})),changeBtns.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault();const t=e.target.previousElementSibling;t.classList.remove("disabled"),t.focus()}))})),saveChangesBtn.addEventListener("click",(e=>{const t=JSON.parse(localStorage.getItem("accountsObj")),a=userNameInput.value,r=baseCurrencySelect.value;if(a&&a!==userNameVal){localStorage.setItem("username",`${a}`);const e=a.split(" ")[0];headUserName.innerText=e}r!==baseCurrencyVal&&(localStorage.setItem("base__currency",`${r}`),t["account-1"].currency=r,localStorage.setItem("accountsObj",JSON.stringify(t))),e.preventDefault()})),cancelChangesBtn.addEventListener("click",(e=>{e.preventDefault(),userNameInput.value=localStorage.getItem("username");const t=localStorage.getItem("base__currency"),a=baseCurrencySelect.options;for(let e=0;e<a.length;e++){baseCurrencySelect[e].value===t&&(baseCurrencySelect[e].selected=!0)}})),deleteUserData.addEventListener("click",(e=>{localStorage.clear(),location.replace("/")}));const openModal=e=>{confirmDeleteMsg.classList.remove("hide-2"),overlay.classList.remove("hide-2")},closeModal=e=>{confirmDeleteMsg.classList.add("hide-2"),overlay.classList.add("hide-2")};deleteAcc.addEventListener("click",openModal),closeModalBtn.addEventListener("click",closeModal),cancelDelete.addEventListener("click",closeModal),overlay.addEventListener("click",closeModal),document.addEventListener("keydown",(e=>{"Escape"!==e.key||confirmDeleteMsg.classList.contains("hide-2")||closeModal()}));const readURL=e=>{console.log(uploadUserImg.value);const t=document.querySelector(".upload__image").files[0],a=new FileReader;t&&a.readAsDataURL(t),a.addEventListener("load",(e=>{profilePic.style.backgroundImage=`url("${a.result}")`,headUserImage.style.backgroundImage=`url("${a.result}")`,localStorage.setItem("profile-image",`url("${a.result}")`)}))};uploadUserImg.addEventListener("change",readURL),profileImageUrl&&(profilePic.style.backgroundImage=profileImageUrl),deleteUserImg.addEventListener("click",(e=>{profilePic.style.backgroundImage=defaultProfileImgUrl,headUserImage.style.backgroundImage=defaultProfileImgUrl,localStorage.setItem("profile-image",defaultProfileImgUrl),uploadUserImg.value=""}));