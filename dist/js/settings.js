const userNameInput=document.querySelector(".settings__form .username__input"),userNameVal=localStorage.getItem("username"),baseCurrencySelect=document.querySelector(".base__currency-select"),baseCurrencyVal=localStorage.getItem("base__currency"),changeBtns=document.querySelectorAll(".settings__form .change"),saveChangesBtn=document.querySelector(".user__info .save"),headUserName=document.querySelector(".head .username"),cancelChangesBtn=document.querySelector(".user__info .cancel"),deleteUserData=document.querySelector(".confirm__account-deletion .delete"),confirmDeleteMsg=document.querySelector(".confirm__account-deletion"),overlay=document.querySelector(".settings .overlay"),closeModalBtn=document.querySelector(".confirm__account-deletion .close__icon"),cancelDelete=document.querySelector(".confirm__account-deletion .cancel"),deleteAcc=document.querySelector(".delete__user-account");userNameInput.value=userNameVal,fetch("../static/data/countriesInfo.json").then((e=>e.json())).then((e=>{e.forEach((e=>{const t=e.countryName,c=e.currencyName,a=e.currencyCode,n=`<option ${a===baseCurrencyVal?"selected":""} value="${a}" data-country-name=${t}>${a} - ${c}</option>`;baseCurrencySelect.insertAdjacentHTML("beforeend",n)}))})),changeBtns.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault();const t=e.target.previousElementSibling;t.classList.remove("disabled"),t.focus()}))})),saveChangesBtn.addEventListener("click",(e=>{const t=JSON.parse(localStorage.getItem("accountsObj")),c=userNameInput.value,a=baseCurrencySelect.value;if(c&&c!==userNameVal){localStorage.setItem("username",`${c}`);const e=c.split(" ")[0];headUserName.innerText=e}a!==baseCurrencyVal&&(localStorage.setItem("base__currency",`${a}`),t["account-1"].currency=a,localStorage.setItem("accountsObj",JSON.stringify(t))),e.preventDefault()})),cancelChangesBtn.addEventListener("click",(e=>{e.preventDefault(),userNameInput.value=localStorage.getItem("username");const t=localStorage.getItem("base__currency"),c=baseCurrencySelect.options;for(let e=0;e<c.length;e++){baseCurrencySelect[e].value===t&&(baseCurrencySelect[e].selected=!0)}})),deleteUserData.addEventListener("click",(e=>{localStorage.clear(),location.replace("/")}));const openModal=e=>{confirmDeleteMsg.classList.remove("hide-2"),overlay.classList.remove("hide-2")},closeModal=e=>{confirmDeleteMsg.classList.add("hide-2"),overlay.classList.add("hide-2")};deleteAcc.addEventListener("click",openModal),closeModalBtn.addEventListener("click",closeModal),cancelDelete.addEventListener("click",closeModal),overlay.addEventListener("click",closeModal),document.addEventListener("keydown",(e=>{"Escape"!==e.key||confirmDeleteMsg.classList.contains("hide-2")||closeModal()}));