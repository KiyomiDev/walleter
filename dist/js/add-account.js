const addAccountBtn=document.querySelector(".add__account-btn"),accountModal=document.querySelector(".account__modal"),accountModalTitle=document.querySelector(".account__modal .title"),closeModalBtn=document.querySelector(".account__modal .close__modal"),overlay=document.querySelector(".overlay"),accountNameEl=document.querySelector(".account__modal .account__name"),accountColorEl=document.querySelector(".account__modal .account__color"),accountTypeEl=document.querySelector(".account__modal .account__type"),accountStartingAmountEl=document.querySelector(".account__modal .starting__amount"),accountCurrencyEl=document.querySelector(".account__modal .account__currency"),saveAccountBtn=document.querySelector(".account__modal .save__account"),dashboardAccounts=document.querySelector(".dashboard .accounts"),currentPathname=location.pathname;let accountNum=0,accountsObj={};null!=localStorage.getItem("accountsObj")&&(accountsObj=JSON.parse(localStorage.getItem("accountsObj")));const openModal=t=>{accountModalTitle.innerText="add account",accountModal.classList.remove("hide-2"),overlay.classList.remove("hide-2"),accountNameEl.focus()},closeModal=t=>{accountModal.classList.add("hide-2"),overlay.classList.add("hide-2")};addAccountBtn.addEventListener("click",openModal),closeModalBtn.addEventListener("click",closeModal),overlay.addEventListener("click",closeModal),document.addEventListener("keydown",(t=>{"Escape"!==t.key||accountModal.classList.contains("hide-2")||closeModal()}));const saveAccountData=t=>{const c=accountNameEl.value,o=accountColorEl.value,a=accountTypeEl.value,e=accountStartingAmountEl.value,n=accountCurrencyEl.value;localStorage.setItem("account-name",c),localStorage.setItem("account-color",o),localStorage.setItem("account-type",a),localStorage.setItem("account-starting-amount",e),localStorage.setItem("account-currency",n)};saveAccountBtn.addEventListener("click",(t=>{t.preventDefault(),"ADD ACCOUNT"===accountModalTitle.innerText?(saveAccountData(),addAccount(),closeModal()):(saveAccountData(),initializeFormToEdit(),editAccount(),closeModal())}));const getData=t=>[localStorage.getItem("account-name"),localStorage.getItem("account-type"),localStorage.getItem("account-currency"),localStorage.getItem("account-starting-amount"),localStorage.getItem("account-color")],addAccToDashboard=(t,c,o,a,e)=>{const n=dashboardAccounts.offsetWidth*(matchMedia("(max-width: 368px)")?25:18)/100,l=dashboardAccounts.children;let u=0;for(let t=0;t<l.length;t++)u+=parseInt(l[t].offsetWidth,10);if(u<dashboardAccounts.offsetWidth-n){const c=document.createElement("div");c.id="account-"+ ++accountNum,c.classList.add("account");const n=`\n          <i class="fa-solid fa-sack-dollar icon"></i>\n          <div class="info">\n            <h3 class="account__name">${t}</h3>\n            <span class="currency">${o} </span>\n            <span class="amount">${a}</span>\n          </div>\n          <i class="fa-solid fa-pen edit"></i>\n      `;c.innerHTML=n,c.style.backgroundColor=`${e}`,dashboardAccounts.insertBefore(c,dashboardAccounts.lastChild)}},addAccount=t=>{let[c,o,a,e,n]=getData();"/dashboard.html"===currentPathname&&(addAccToDashboard(c,0,a,e,n),saveAllAccountsData(c,o,a,e,n),initializeFormToEdit())},increaseAccountsNumber=t=>{let c=Number(localStorage.getItem("accounts-count"));localStorage.setItem("accounts-count",++c)},saveAllAccountsData=(t,c,o,a,e)=>{increaseAccountsNumber();const n=`account-${localStorage.getItem("accounts-count")}`;accountsObj[n]={name:t,type:c,currency:o,amount:a,color:e},localStorage.setItem("accountsObj",JSON.stringify(accountsObj))},displayAccounts=t=>{const c=JSON.parse(localStorage.getItem("accountsObj"));for(const o in c){const a=c[o].name,e=c[o].type,n=c[o].amount;t(a,e,c[o].currency,n,c[o].color)}},formUpdate=t=>{accountModalTitle.innerText="edit account",accountCurrencyEl.setAttribute("disabled",""),accountCurrencyEl.style.cursor="not-allowed",closeModalBtn.addEventListener("click",closeModal),overlay.addEventListener("click",closeModal),localStorage.setItem("changed-id",t);const c=JSON.parse(localStorage.getItem("accountsObj"));accountNameEl.value=c[t].name,accountTypeEl.value=c[t].type,accountColorEl.value=c[t].color,accountStartingAmountEl.value=c[t].amount},initializeFormToEdit=t=>{Array.from(document.querySelectorAll(".edit")).forEach((t=>{t.addEventListener("click",(t=>{const c=t.target.parentNode.id;openModal(),formUpdate(c)}))}))};function editAccount(){const t=localStorage.getItem("changed-id"),c=document.getElementById(t),[o,a,,e,n]=getData(),l=document.querySelector(`#${t} .account__name`),u=document.querySelector(`#${t} .amount`);l.innerText=o,u.innerText=e,c.style.backgroundColor=`${n}`;let r=JSON.parse(localStorage.getItem("accountsObj"));r[t].name=o,r[t].amount=e,r[t].type=a,r[t].color=n,localStorage.setItem("accountsObj",JSON.stringify(r))}"/dashboard.html"===currentPathname&&(displayAccounts(addAccToDashboard),initializeFormToEdit());